<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Dashboard de Business Intelligence em Tempo Real para CDL Manaus. Monitore indicadores financeiros, comerciais e de produtos com alertas automatizados.">
    <meta name="keywords" content="BI, Business Intelligence, Dashboard, CDL Manaus, Gest√£o de Dados, KPIs">
    <title>Dashboard - CDL Manaus - Ecossistema de Intelig√™ncia de Dados</title>
    <link rel="stylesheet" href="webapp/static/css/style.css">
    <style>
        /* Additional styles for static version */
        .test-alert-banner {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            padding: 1rem;
            text-align: center;
            font-weight: bold;
            margin-bottom: 1rem;
            border-radius: 5px;
        }
        .test-controls {
            background: #fff;
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }
        .test-controls h3 {
            color: #2c3e50;
            margin-bottom: 1rem;
        }
        .test-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }
        .test-btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 5px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
            color: white;
        }
        .test-btn:focus {
            outline: 3px solid #ffa500;
            outline-offset: 2px;
        }
        .test-btn-alert1 { background: #e74c3c; }
        .test-btn-alert1:hover { background: #c0392b; }
        .test-btn-alert2 { background: #f39c12; }
        .test-btn-alert2:hover { background: #e67e22; }
        .test-btn-alert3 { background: #3498db; }
        .test-btn-alert3:hover { background: #2980b9; }
        .alert-simulation {
            position: fixed;
            bottom: 20px;
            right: 20px;
            max-width: 400px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.2);
            padding: 1.5rem;
            display: none;
            z-index: 1000;
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        .alert-simulation.show {
            display: block;
        }
        .alert-simulation .close-alert {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #95a5a6;
        }
        .alert-simulation .close-alert:focus {
            outline: 3px solid #ffa500;
            outline-offset: 2px;
        }
        .skip-to-content {
            position: absolute;
            left: -9999px;
            z-index: 999;
            padding: 1rem;
            background-color: #3498db;
            color: white;
            text-decoration: none;
        }
        .skip-to-content:focus {
            left: 50%;
            transform: translateX(-50%);
            top: 1rem;
        }
        @media (max-width: 768px) {
            .nav-menu {
                display: none;
                flex-direction: column;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: var(--primary-color);
                padding: 1rem;
                gap: 1rem;
            }
            .nav-menu.active {
                display: flex;
            }
            .mobile-menu-toggle {
                display: block;
                background: none;
                border: none;
                color: white;
                font-size: 1.5rem;
                cursor: pointer;
                padding: 0.5rem;
            }
            .mobile-menu-toggle:focus {
                outline: 3px solid #ffa500;
                outline-offset: 2px;
            }
        }
        @media (min-width: 769px) {
            .mobile-menu-toggle {
                display: none;
            }
        }
        .alert-simulation h4 {
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }
        .alert-simulation p {
            margin-bottom: 0.5rem;
            line-height: 1.5;
        }
        .alert-simulation .alert-type {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }
        .alert-type.critical { background: #e74c3c; color: white; }
        .alert-type.warning { background: #f39c12; color: white; }
        .alert-type.info { background: #3498db; color: white; }
    </style>
</head>
<body>
    <!-- Skip to content link for keyboard navigation -->
    <a href="#main-content" class="skip-to-content">Pular para o conte√∫do principal</a>
    
    <header role="banner">
        <nav class="navbar" role="navigation" aria-label="Navega√ß√£o principal">
            <div class="container">
                <div class="logo">
                    <h1>üè¢ CDL Manaus</h1>
                    <p class="subtitle">Ecossistema de Intelig√™ncia de Dados</p>
                </div>
                <button class="mobile-menu-toggle" 
                        aria-label="Menu de navega√ß√£o" 
                        aria-expanded="false"
                        aria-controls="main-nav"
                        onclick="toggleMobileMenu()">
                    ‚ò∞
                </button>
                <ul class="nav-menu" id="main-nav" role="menu">
                    <li role="none"><a href="index.html" role="menuitem" aria-current="page">Dashboard</a></li>
                    <li role="none"><a href="alerts.html" role="menuitem">Sistema de Alertas</a></li>
                    <li role="none"><a href="https://github.com/mayconabentes-bi/Ecossistema-de-Intelig-ncia-de-Dados" target="_blank" rel="noopener noreferrer" role="menuitem" aria-label="Documenta√ß√£o (abre em nova aba)">Documenta√ß√£o</a></li>
                </ul>
            </div>
        </nav>
    </header>

    <main class="container" id="main-content" role="main">
        <div class="test-alert-banner" role="banner" aria-label="Aviso do sistema">
            üöÄ SISTEMA ONLINE VIA GITHUB PAGES - AMBIENTE DE TESTES E DEMONSTRA√á√ÉO
        </div>

        <div class="info-section" style="margin-bottom: 2rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 10px; padding: 1.5rem;">
            <h3 style="color: white; margin-bottom: 1rem;">‚ú® Novidades: Sistema Completo com ETL e Entrada de Dados</h3>
            <p style="margin-bottom: 0.75rem;">Esta √© a vers√£o de demonstra√ß√£o est√°tica. O sistema completo agora inclui:</p>
            <ul style="margin-left: 1.5rem; margin-bottom: 1rem;">
                <li><strong>Pipeline ETL</strong>: Importa√ß√£o autom√°tica de dados CSV do sistema legado</li>
                <li><strong>Banco de Dados SQLite</strong>: Persist√™ncia de dados com hist√≥rico completo</li>
                <li><strong>Sistema de Login</strong>: Autentica√ß√£o segura para entrada de dados</li>
                <li><strong>Entrada de Dados Web</strong>: Interface para registro de faturamento e KPIs</li>
            </ul>
            <p style="margin-bottom: 0.5rem;"><strong>üì¶ Para executar o sistema completo:</strong></p>
            <p style="font-family: monospace; background: rgba(0,0,0,0.2); padding: 0.75rem; border-radius: 5px; margin-bottom: 1rem;">
                cd webapp && pip install -r requirements.txt && python app.py
            </p>
            <p style="margin-bottom: 0;">
                <a href="https://github.com/mayconabentes-bi/Ecossistema-de-Intelig-ncia-de-Dados/tree/main/webapp" target="_blank" style="color: white; font-weight: bold; text-decoration: underline;">üìö Ver documenta√ß√£o completa do webapp ‚Üí</a>
            </p>
        </div>

        <section class="hero">
            <h2>üìä Dashboard de Visualiza√ß√£o de Dados</h2>
            <p class="hero-subtitle">Monitoramento em tempo real dos indicadores estrat√©gicos</p>
        </section>

        <section class="test-controls" aria-labelledby="test-controls-title">
            <h3 id="test-controls-title">üß™ Painel de Testes de Alertas</h3>
            <p style="margin-bottom: 1rem; color: #7f8c8d;">Clique nos bot√µes abaixo para simular os alertas do sistema:</p>
            <div class="test-buttons" role="group" aria-label="Bot√µes de teste de alertas">
                <button class="test-btn test-btn-alert1" 
                        onclick="testAlert1()"
                        aria-label="Testar Alerta 1: Queda de Cliente Top 20"
                        title="Simula um alerta cr√≠tico de queda de faturamento de cliente importante">
                    üî¥ Testar Alerta 1: Queda Cliente Top 20
                </button>
                <button class="test-btn test-btn-alert2" 
                        onclick="testAlert2()"
                        aria-label="Testar Alerta 2: Burn Rate Negativo Consecutivo"
                        title="Simula um alerta de queima de caixa por 2 meses consecutivos">
                    üü° Testar Alerta 2: Burn Rate Negativo
                </button>
                <button class="test-btn test-btn-alert3" 
                        onclick="testAlert3()"
                        aria-label="Testar Alerta 3: Margem SPC Abaixo da Meta"
                        title="Simula um alerta de margem de contribui√ß√£o abaixo do limite">
                    üîµ Testar Alerta 3: Margem SPC Baixa
                </button>
            </div>
        </section>

        <div class="dashboard-grid" role="region" aria-label="Pain√©is de indicadores">
            <!-- Painel A: O Pulm√£o (Financeiro) -->
            <article class="panel" aria-labelledby="painel-a-title">
                <div class="panel-header">
                    <h3 id="painel-a-title">ü´Å Painel A: O Pulm√£o</h3>
                    <span class="panel-subtitle">Financeiro / Caixa</span>
                </div>
                <div class="panel-content">
                    <div class="kpi-grid" role="list" aria-label="Indicadores financeiros">
                        <div class="kpi-card" role="listitem">
                            <div class="kpi-label" id="label-saldo-caixa">Saldo de Caixa</div>
                            <div class="kpi-value" id="saldo-caixa" aria-labelledby="label-saldo-caixa" aria-describedby="desc-saldo-caixa">R$ 1.250.000</div>
                            <div class="kpi-change positive" id="desc-saldo-caixa">+5,2% vs m√™s anterior</div>
                        </div>
                        <div class="kpi-card" role="listitem">
                            <div class="kpi-label" id="label-iar">IAR</div>
                            <div class="kpi-value" id="iar" aria-labelledby="label-iar" aria-describedby="desc-iar" title="√çndice de Arrecada√ß√£o Real">1.01</div>
                            <div class="kpi-change neutral" id="desc-iar">√çndice de Arrecada√ß√£o Real</div>
                        </div>
                        <div class="kpi-card" role="listitem">
                            <div class="kpi-label" id="label-burn-rate">Burn Rate</div>
                            <div class="kpi-value negative" id="burn-rate" aria-labelledby="label-burn-rate" aria-describedby="desc-burn-rate">R$ -83.923</div>
                            <div class="kpi-change negative" id="desc-burn-rate">Nov/2025</div>
                        </div>
                        <div class="kpi-card" role="listitem">
                            <div class="kpi-label" id="label-suspensos">Estoque Suspensos</div>
                            <div class="kpi-value warning" id="suspensos" aria-labelledby="label-suspensos" aria-describedby="desc-suspensos">R$ 742.779</div>
                            <div class="kpi-change warning" id="desc-suspensos">Requer aten√ß√£o</div>
                        </div>
                    </div>
                </div>
            </article>

            <!-- Painel B: O Motor (Comercial) -->
            <article class="panel" aria-labelledby="painel-b-title">
                <div class="panel-header">
                    <h3 id="painel-b-title">‚öôÔ∏è Painel B: O Motor</h3>
                    <span class="panel-subtitle">Comercial / Carteira</span>
                </div>
                <div class="panel-content">
                    <div class="kpi-grid" role="list" aria-label="Indicadores comerciais">
                        <div class="kpi-card" role="listitem">
                            <div class="kpi-label" id="label-icio">ICIO (Top 20)</div>
                            <div class="kpi-value" id="icio" aria-labelledby="label-icio" aria-describedby="desc-icio" title="√çndice de Concentra√ß√£o dos 20 maiores clientes">45%</div>
                            <div class="kpi-change neutral" id="desc-icio">√çndice de Concentra√ß√£o</div>
                        </div>
                        <div class="kpi-card" role="listitem">
                            <div class="kpi-label" id="label-churn">Churn Real</div>
                            <div class="kpi-value" id="churn" aria-labelledby="label-churn" aria-describedby="desc-churn">3.2%</div>
                            <div class="kpi-change positive" id="desc-churn">Abaixo da meta</div>
                        </div>
                        <div class="kpi-card" role="listitem">
                            <div class="kpi-label" id="label-irr">IRR</div>
                            <div class="kpi-value" id="irr" aria-labelledby="label-irr" aria-describedby="desc-irr" title="√çndice de Renova√ß√£o de Receita">70/30</div>
                            <div class="kpi-change neutral" id="desc-irr">Recorrente/Vari√°vel</div>
                        </div>
                        <div class="kpi-card" role="listitem">
                            <div class="kpi-label" id="label-entries">Clientes Ativos</div>
                            <div class="kpi-value" id="entries" aria-labelledby="label-entries" aria-describedby="desc-entries">1.247</div>
                            <div class="kpi-change positive" id="desc-entries">+23 este m√™s</div>
                        </div>
                    </div>
                </div>
            </article>

            <!-- Painel C: A M√°quina (Produtos) -->
            <article class="panel" aria-labelledby="painel-c-title">
                <div class="panel-header">
                    <h3 id="painel-c-title">üè≠ Painel C: A M√°quina</h3>
                    <span class="panel-subtitle">Produtos / Margem</span>
                </div>
                <div class="panel-content">
                    <div class="kpi-grid" role="list" aria-label="Indicadores de produtos">
                        <div class="kpi-card" role="listitem">
                            <div class="kpi-label" id="label-margem-spc">Margem SPC</div>
                            <div class="kpi-value positive" id="margem-spc" aria-labelledby="label-margem-spc" aria-describedby="desc-margem-spc">62.3%</div>
                            <div class="kpi-change positive" id="desc-margem-spc">Acima da meta (60%)</div>
                        </div>
                        <div class="kpi-card" role="listitem">
                            <div class="kpi-label" id="label-cert-digital">Certificado Digital</div>
                            <div class="kpi-value warning" id="cert-digital" aria-labelledby="label-cert-digital" aria-describedby="desc-cert-digital">23%</div>
                            <div class="kpi-change warning" id="desc-cert-digital">Margem baixa</div>
                        </div>
                        <div class="kpi-card" role="listitem">
                            <div class="kpi-label" id="label-receita">Receita Mensal</div>
                            <div class="kpi-value" id="receita" aria-labelledby="label-receita" aria-describedby="desc-receita">R$ 850.000</div>
                            <div class="kpi-change positive" id="desc-receita">+8,5% vs m√™s anterior</div>
                        </div>
                        <div class="kpi-card" role="listitem">
                            <div class="kpi-label" id="label-custo">Custo Vari√°vel</div>
                            <div class="kpi-value" id="custo" aria-labelledby="label-custo" aria-describedby="desc-custo">R$ 320.500</div>
                            <div class="kpi-change neutral" id="desc-custo">37,7% da receita</div>
                        </div>
                    </div>
                </div>
            </article>
        </div>

        <div class="info-section">
            <h3>üìã Sobre o Sistema</h3>
            <p>Este dashboard apresenta uma vis√£o consolidada dos principais indicadores do Ecossistema de Intelig√™ncia de Dados da CDL Manaus.</p>
            <ul>
                <li><strong>Painel A (O Pulm√£o):</strong> Monitora a sa√∫de financeira e fluxo de caixa</li>
                <li><strong>Painel B (O Motor):</strong> Acompanha a carteira de clientes e receita comercial</li>
                <li><strong>Painel C (A M√°quina):</strong> Analisa a rentabilidade e margem por produto</li>
            </ul>
            
            <h4 style="margin-top: 1.5rem; color: #2c3e50;">üîÑ Pipeline ETL e Entrada de Dados</h4>
            <p>O sistema completo inclui funcionalidades avan√ßadas de processamento de dados:</p>
            <ul>
                <li><strong>Importa√ß√£o CSV:</strong> Pipeline ETL para migra√ß√£o de dados do sistema legado (RESUMO EXECUTIVO)</li>
                <li><strong>Persist√™ncia:</strong> Banco de dados SQLite com hist√≥rico completo de transa√ß√µes</li>
                <li><strong>Interface Web:</strong> Sistema de entrada de dados com login seguro e valida√ß√£o</li>
                <li><strong>API RESTful:</strong> Endpoints para integra√ß√£o com outros sistemas</li>
            </ul>
            
            <p class="access-info">
                <strong>Sistema de Testes:</strong> Este √© um ambiente de demonstra√ß√£o est√°tica. Use o painel de testes acima para simular alertas do sistema. Para mais informa√ß√µes, consulte a <a href="alerts.html">p√°gina de Sistema de Alertas</a> ou a <a href="https://github.com/mayconabentes-bi/Ecossistema-de-Intelig-ncia-de-Dados/blob/main/SISTEMA_ALERTAS.md" target="_blank">documenta√ß√£o completa</a>.
            </p>
            
            <p class="access-info" style="margin-top: 1rem; padding: 1rem; background: #e8f4f8; border-left: 4px solid #3498db; border-radius: 5px;">
                <strong>üíª Sistema Completo:</strong> Para executar o webapp completo com todas as funcionalidades (ETL, entrada de dados, autentica√ß√£o), consulte o <a href="https://github.com/mayconabentes-bi/Ecossistema-de-Intelig-ncia-de-Dados/blob/main/webapp/README.md" target="_blank" style="font-weight: bold;">README do webapp</a>.
            </p>
        </div>

        <!-- Alert Simulation Container -->
        <div id="alertSimulation" class="alert-simulation" role="alertdialog" aria-labelledby="alert-title" aria-describedby="alert-description" aria-live="assertive" aria-atomic="true">
            <button class="close-alert" onclick="closeAlert()" aria-label="Fechar alerta">√ó</button>
            <div id="alertContent"></div>
        </div>
    </main>

    <footer role="contentinfo">
        <div class="container">
            <p>&copy; 2025 CDL Manaus - Todos os direitos reservados</p>
            <p class="footer-info">Sistema de Business Intelligence em Tempo Real | Vers√£o Online via GitHub Pages</p>
            <p class="footer-info" style="font-size: 0.85rem; margin-top: 0.5rem;">v2.0 - Agora com ETL Pipeline, SQLite e Sistema de Entrada de Dados</p>
        </div>
    </footer>

    <script>
        // Mobile menu toggle
        function toggleMobileMenu() {
            const menu = document.getElementById('main-nav');
            const button = document.querySelector('.mobile-menu-toggle');
            const isExpanded = button.getAttribute('aria-expanded') === 'true';
            
            menu.classList.toggle('active');
            button.setAttribute('aria-expanded', !isExpanded);
        }

        // Close mobile menu when clicking outside
        document.addEventListener('click', function(event) {
            const menu = document.getElementById('main-nav');
            const button = document.querySelector('.mobile-menu-toggle');
            const isClickInside = menu.contains(event.target) || button.contains(event.target);
            
            if (!isClickInside && menu.classList.contains('active')) {
                menu.classList.remove('active');
                button.setAttribute('aria-expanded', 'false');
            }
        });

        // Keyboard navigation for alerts
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeAlert();
            }
        });

        function testAlert1() {
            const content = `
                <h4>üî¥ ALERTA CR√çTICO</h4>
                <span class="alert-type critical">Alerta 1: Queda Cliente Top 20</span>
                <p><strong>Cliente:</strong> Bemol S.A.</p>
                <p><strong>Queda:</strong> -25,3% vs. m√©dia 4 semanas</p>
                <p><strong>üìä Dados:</strong></p>
                <ul style="margin-left: 1.5rem; margin-bottom: 1rem;">
                    <li>M√©dia 4 semanas: R$ 42.500</li>
                    <li>Semana atual: R$ 31.745</li>
                    <li>Diferen√ßa: -R$ 10.755</li>
                </ul>
                <p><strong>‚ö†Ô∏è A√á√ÉO RECOMENDADA:</strong></p>
                <p>Agendar reuni√£o com cliente nas pr√≥ximas 48h para entender motivo da redu√ß√£o.</p>
                <p style="margin-top: 1rem; color: #7f8c8d; font-size: 0.85rem;">üìÖ ${new Date().toLocaleString('pt-BR')}</p>
            `;
            showAlert(content);
        }

        function testAlert2() {
            const content = `
                <h4>üü° ALERTA CR√çTICO</h4>
                <span class="alert-type warning">Alerta 2: Burn Rate Negativo</span>
                <p><strong>‚ö†Ô∏è Situa√ß√£o:</strong> Queimando caixa por 2 meses consecutivos</p>
                <p><strong>üìä Dados:</strong></p>
                <ul style="margin-left: 1.5rem; margin-bottom: 1rem;">
                    <li>Out/2025: -R$ 45.200</li>
                    <li>Nov/2025: -R$ 83.923</li>
                    <li>Total queimado: -R$ 129.123</li>
                </ul>
                <p><strong>üí° Proje√ß√£o:</strong></p>
                <p>Se mantiver ritmo, caixa zerado em: Abril/2026</p>
                <p><strong>üö® A√á√ÉO IMEDIATA NECESS√ÅRIA:</strong></p>
                <ol style="margin-left: 1.5rem; margin-bottom: 1rem;">
                    <li>Reuni√£o emergencial Diretoria (24h)</li>
                    <li>Plano de conting√™ncia: cortar despesas n√£o-essenciais</li>
                    <li>Intensificar cobran√ßa e rever precifica√ß√£o</li>
                </ol>
                <p style="margin-top: 1rem; color: #7f8c8d; font-size: 0.85rem;">üìÖ ${new Date().toLocaleString('pt-BR')}</p>
            `;
            showAlert(content);
        }

        function testAlert3() {
            const content = `
                <h4>üîµ ALERTA DE ATEN√á√ÉO</h4>
                <span class="alert-type info">Alerta 3: Margem SPC Abaixo da Meta</span>
                <p><strong>‚ö†Ô∏è Margem SPC:</strong> 57,2% (Meta: >60%)</p>
                <p><strong>üìä Dados Nov/2025:</strong></p>
                <ul style="margin-left: 1.5rem; margin-bottom: 1rem;">
                    <li>Receita SPC: R$ 650.000</li>
                    <li>Custo SPC: R$ 278.280</li>
                    <li>Margem: 57,2%</li>
                </ul>
                <p><strong>üí° A√á√ïES RECOMENDADAS (Priorizar):</strong></p>
                <ol style="margin-left: 1.5rem; margin-bottom: 1rem;">
                    <li>Renegociar tarifa com fornecedor SPC</li>
                    <li>Revisar precifica√ß√£o (aumento de 5-10%)</li>
                    <li>Reduzir custo por consulta (volume)</li>
                </ol>
                <p style="margin-top: 1rem; color: #7f8c8d; font-size: 0.85rem;">üìÖ ${new Date().toLocaleString('pt-BR')}</p>
            `;
            showAlert(content);
        }

        function showAlert(content) {
            const alertBox = document.getElementById('alertSimulation');
            const alertContent = document.getElementById('alertContent');
            alertContent.innerHTML = content;
            alertBox.classList.add('show');
            
            // Set focus to the close button for accessibility
            setTimeout(() => {
                const closeButton = alertBox.querySelector('.close-alert');
                if (closeButton) {
                    closeButton.focus();
                }
            }, 100);
            
            // Auto-close after 10 seconds
            setTimeout(() => {
                closeAlert();
            }, 10000);
        }

        function closeAlert() {
            const alertBox = document.getElementById('alertSimulation');
            alertBox.classList.remove('show');
        }

        // Simulate real-time data updates
        function updateKPIs() {
            // This would normally fetch from an API
            // For demo purposes, we'll just add visual feedback
            console.log('Dashboard carregado - ' + new Date().toLocaleString('pt-BR'));
        }

        // Initialize
        updateKPIs();
        
        // Update every 30 seconds (demonstration)
        setInterval(updateKPIs, 30000);

        // Handle hash parameters from alerts.html links
        window.addEventListener('load', () => {
            const hash = window.location.hash;
            if (hash === '#test-alert1') {
                setTimeout(() => testAlert1(), 500);
            } else if (hash === '#test-alert2') {
                setTimeout(() => testAlert2(), 500);
            } else if (hash === '#test-alert3') {
                setTimeout(() => testAlert3(), 500);
            }
        });
    </script>
</body>
</html>
